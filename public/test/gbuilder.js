const GBuilder = require('../components/graphbuilder');
const chai = require('chai')
const should = chai.should();

let nodes = [
  {
    "name": "Spring-Petclinic",
    "type": "Server",
    "id": 1,
    "index": 0,
    "x": 535.4497484516137,
    "y": 199.20348822434354,
    "vy": -3.0964814046186e-17,
    "vx": 3.379458171637317e-17
  },
  {
    "name": "HSQL Database Engine",
    "type": "Database",
    "id": 2,
    "index": 1,
    "x": 424.55025154838626,
    "y": 300.7965117756564,
    "vy": 3.0964814046186e-17,
    "vx": -3.379458171637317e-17
  }
]
let mdata = [
  {
    "duration_cpu_ms": 15.983589,
    "instance": "dev",
    "http.headers.accept-language": "en-US,en;q=0.9,it;q=0.8",
    "tracking.unique_visitor_id": "1777b5fde5288fac54a8cbda59deaf27f22b4063",
    "http.url": "/spring-petclinic/owners/find",
    "type": "http",
    "http.headers.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
    "error": false,
    "http.headers.referer": "http://34.245.47.230/spring-petclinic/",
    "user_agent.type": "Browser",
    "http.headers.connection": "close",
    "http.headers.host": "localhost:8080",
    "span.kind": "server",
    "host": "ip-172-31-22-53",
    "user_agent.os_version": "10.11.6",
    "id": "fec35e505b75754e",
    "user_agent.browser": "Chrome",
    "call_tree_ascii": "----------------------------------------------------------------------\nSelftime (ms)              Total (ms)                 Method signature\n----------------------------------------------------------------------\n000009.82  023% ██░░░░░░░░ 000043.30  100% ██████████ Init Find Form\n000001.10  003% ░░░░░░░░░░ 000033.49  077% ███████▓░░ └── FrameworkServlet#service\n000032.39  075% ███████░░░ 000032.39  075% ███████░░░     └── DispatcherServlet#render\n",
    "trace_id": "fec35e505b75754e",
    "method": "GET",
    "ip": "127.0.0.0",
    "user_agent.os_family": "OS X",
    "http.headers.user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36",
    "peer.port": 52078,
    "duration_ms": 37.266249,
    "http.status_code": 200,
    "http.headers.accept-encoding": "gzip, deflate",
    "@timestamp": "2018-03-25T17:16:00.910+0000",
    "application": "Spring-Petclinic",
    "user_agent.os": "OS X",
    "stagemonitor.version": "0.87.5",
    "http.referring_site": "34.245.47.230",
    "user_agent.device": "Personal computer",
    "user_agent.browser_version": "65.0.3325.181",
    "name": "Init Find Form",
    "http.headers.upgrade-insecure-requests": "1",
    "peer.ipv4_string": "127.0.0.0"
  },
  {
    "trace_id": "50a80b9b6a09065e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select distinct owner0_.id as id1_0_0_, pets1_.id as id1_1_1_, owner0_.first_name as first_na2_0_0_, owner0_.last_name as last_nam3_0_0_, owner0_.address as address4_0_0_, owner0_.city as city5_0_0_, owner0_.telephone as telephon6_0_0_, pets1_.name as name2_1_1_, pets1_.birth_date as birth_da3_1_1_, pets1_.owner_id as owner_id4_1_1_, pets1_.type_id as type_id5_1_1_, pets1_.owner_id as owner_id4_1_0__, pets1_.id as id1_1_0__ from owners owner0_ left outer join pets pets1_ on owner0_.id=pets1_.owner_id where owner0_.last_name like '%'",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.664419,
    "db.user": "SA",
    "@timestamp": "2018-03-25T17:16:02.591+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "50a80b9b6a09065e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "2fa1530d1f627391"
  },
  {
    "trace_id": "50a80b9b6a09065e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=6",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.191499,
    "db.user": "SA",
    "@timestamp": "2018-03-25T17:16:02.609+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "50a80b9b6a09065e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "a6ff7f9fb87f3182"
  },
  {
    "duration_cpu_ms": 347.15079,
    "instance": "dev",
    "http.headers.accept-language": "en-US,en;q=0.9,it;q=0.8",
    "tracking.unique_visitor_id": "1777b5fde5288fac54a8cbda59deaf27f22b4063",
    "http.url": "/spring-petclinic/owners/find",
    "type": "http",
    "http.headers.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
    "error": false,
    "http.headers.referer": "http://34.245.47.230/spring-petclinic/",
    "user_agent.type": "Browser",
    "http.headers.connection": "close",
    "http.headers.host": "localhost:8080",
    "span.kind": "server",
    "host": "ip-172-31-22-53",
    "user_agent.os_version": "10.11.6",
    "id": "2a3a88eb0dc0b993",
    "user_agent.browser": "Chrome",
    "call_tree_ascii": "----------------------------------------------------------------------\nSelftime (ms)              Total (ms)                 Method signature\n----------------------------------------------------------------------\n000369.60  092% █████████░ 000400.06  100% ██████████ Init Find Form\n000001.17  000% ░░░░░░░░░░ 000030.46  008% ▓░░░░░░░░░ └── FrameworkServlet#service\n000029.29  007% ▓░░░░░░░░░ 000029.29  007% ▓░░░░░░░░░     └── DispatcherServlet#render\n",
    "trace_id": "2a3a88eb0dc0b993",
    "method": "GET",
    "ip": "127.0.0.0",
    "user_agent.os_family": "OS X",
    "http.headers.user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36",
    "peer.port": 51952,
    "duration_ms": 399.383739,
    "http.status_code": 200,
    "http.headers.accept-encoding": "gzip, deflate",
    "@timestamp": "2018-03-25T17:15:42.486+0000",
    "application": "Spring-Petclinic",
    "user_agent.os": "OS X",
    "parent_id": "d7199723cfb361ca",
    "stagemonitor.version": "0.87.5",
    "http.referring_site": "34.245.47.230",
    "user_agent.device": "Personal computer",
    "user_agent.browser_version": "65.0.3325.181",
    "name": "Init Find Form",
    "http.headers.upgrade-insecure-requests": "1",
    "peer.ipv4_string": "127.0.0.0"
  },
  {
    "duration_cpu_ms": 364.583532,
    "instance": "dev",
    "http.headers.accept-language": "en-US,en;q=0.9,it;q=0.8",
    "tracking.unique_visitor_id": "1777b5fde5288fac54a8cbda59deaf27f22b4063",
    "http.url": "/spring-petclinic/",
    "type": "http",
    "http.headers.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
    "error": false,
    "user_agent.type": "Browser",
    "http.headers.connection": "close",
    "http.headers.host": "localhost:8080",
    "span.kind": "server",
    "host": "ip-172-31-22-53",
    "user_agent.os_version": "10.11.6",
    "id": "2c2897dae7e0a398",
    "user_agent.browser": "Chrome",
    "call_tree_ascii": "----------------------------------------------------------------------\nSelftime (ms)              Total (ms)                 Method signature\n----------------------------------------------------------------------\n000361.54  083% ████████░░ 000435.59  100% ██████████ Welcome\n000001.20  000% ░░░░░░░░░░ 000074.05  017% █▓░░░░░░░░ └── FrameworkServlet#service\n000072.85  017% █▓░░░░░░░░ 000072.85  017% █▓░░░░░░░░     └── DispatcherServlet#render\n",
    "trace_id": "2c2897dae7e0a398",
    "method": "GET",
    "ip": "127.0.0.0",
    "user_agent.os_family": "OS X",
    "http.headers.user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36",
    "peer.port": 51744,
    "duration_ms": 434.578714,
    "http.status_code": 200,
    "http.headers.accept-encoding": "gzip, deflate",
    "@timestamp": "2018-03-25T17:11:31.678+0000",
    "application": "Spring-Petclinic",
    "user_agent.os": "OS X",
    "parent_id": "60555d352871958d",
    "stagemonitor.version": "0.87.5",
    "user_agent.device": "Personal computer",
    "user_agent.browser_version": "65.0.3325.181",
    "name": "Welcome",
    "http.headers.upgrade-insecure-requests": "1",
    "peer.ipv4_string": "127.0.0.0"
  },
  {
    "trace_id": "50a80b9b6a09065e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=1",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.270042,
    "db.user": "SA",
    "@timestamp": "2018-03-25T17:16:02.600+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "50a80b9b6a09065e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "c990dfd8a75a69b3"
  },
  {
    "trace_id": "50e4dee9a2a478ec",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select distinct owner0_.id as id1_0_0_, pets1_.id as id1_1_1_, owner0_.first_name as first_na2_0_0_, owner0_.last_name as last_nam3_0_0_, owner0_.address as address4_0_0_, owner0_.city as city5_0_0_, owner0_.telephone as telephon6_0_0_, pets1_.name as name2_1_1_, pets1_.birth_date as birth_da3_1_1_, pets1_.owner_id as owner_id4_1_1_, pets1_.type_id as type_id5_1_1_, pets1_.owner_id as owner_id4_1_0__, pets1_.id as id1_1_0__ from owners owner0_ left outer join pets pets1_ on owner0_.id=pets1_.owner_id where owner0_.last_name like 'sdfsadf%'",
    "type": "jdbc",
    "error": false,
    "duration_ms": 12.807653,
    "db.user": "SA",
    "@timestamp": "2018-03-29T13:02:42.432+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "50e4dee9a2a478ec",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "ac1635daaaf968d7"
  },
  {
    "duration_cpu_ms": 30.135393,
    "instance": "dev",
    "http.headers.accept-language": "it-IT,it;q=0.9,en-US;q=0.8,en;q=0.7",
    "tracking.unique_visitor_id": "2a5a943dc195052d486d6dbd1feb3923686d669b",
    "http.url": "/spring-petclinic/",
    "type": "http",
    "http.headers.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
    "error": false,
    "user_agent.type": "Browser",
    "http.headers.connection": "close",
    "http.headers.host": "localhost:8080",
    "span.kind": "server",
    "host": "ip-172-31-22-53",
    "user_agent.os_version": "10.0",
    "id": "01637e2c866836fc",
    "user_agent.browser": "Chrome",
    "call_tree_ascii": "----------------------------------------------------------------------\nSelftime (ms)              Total (ms)                 Method signature\n----------------------------------------------------------------------\n000017.30  030% ██▓░░░░░░░ 000057.78  100% ██████████ Welcome\n000006.53  011% █░░░░░░░░░ 000040.47  070% ███████░░░ └── FrameworkServlet#service\n000033.94  059% █████▓░░░░ 000033.94  059% █████▓░░░░     └── DispatcherServlet#render\n",
    "trace_id": "01637e2c866836fc",
    "method": "GET",
    "ip": "127.0.0.0",
    "user_agent.os_family": "Windows",
    "http.headers.user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36",
    "peer.port": 42140,
    "duration_ms": 57.619109,
    "http.status_code": 200,
    "http.headers.accept-encoding": "gzip, deflate",
    "@timestamp": "2018-03-29T10:25:13.265+0000",
    "application": "Spring-Petclinic",
    "user_agent.os": "Windows",
    "parent_id": "de7f407bf70bcd60",
    "stagemonitor.version": "0.87.5",
    "user_agent.device": "Personal computer",
    "user_agent.browser_version": "65.0.3325.181",
    "name": "Welcome",
    "http.headers.upgrade-insecure-requests": "1",
    "peer.ipv4_string": "127.0.0.0"
  },
  {
    "duration_cpu_ms": 14.759943,
    "instance": "dev",
    "http.headers.accept-language": "en-US,en;q=0.9,it;q=0.8,mt;q=0.7",
    "tracking.unique_visitor_id": "2a5a943dc195052d486d6dbd1feb3923686d669b",
    "http.url": "/spring-petclinic/",
    "type": "http",
    "http.headers.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
    "error": false,
    "user_agent.type": "Browser",
    "http.headers.connection": "close",
    "http.headers.host": "localhost:8080",
    "span.kind": "server",
    "host": "ip-172-31-22-53",
    "user_agent.os_version": "10.0",
    "id": "7c938ebe3bd81af2",
    "user_agent.browser": "Chrome",
    "call_tree_ascii": "----------------------------------------------------------------------\nSelftime (ms)              Total (ms)                 Method signature\n----------------------------------------------------------------------\n000004.24  020% ██░░░░░░░░ 000020.91  100% ██████████ Welcome\n000002.71  013% █░░░░░░░░░ 000016.68  080% ███████▓░░ └── FrameworkServlet#service\n000013.97  067% ██████▓░░░ 000013.97  067% ██████▓░░░     └── DispatcherServlet#render\n",
    "trace_id": "7c938ebe3bd81af2",
    "method": "GET",
    "ip": "127.0.0.0",
    "user_agent.os_family": "Windows",
    "http.headers.user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36",
    "peer.port": 42502,
    "duration_ms": 20.786527,
    "http.status_code": 200,
    "http.headers.accept-encoding": "gzip, deflate",
    "@timestamp": "2018-03-29T11:51:52.381+0000",
    "application": "Spring-Petclinic",
    "user_agent.os": "Windows",
    "parent_id": "ac4d0ea33670b842",
    "stagemonitor.version": "0.87.5",
    "user_agent.device": "Personal computer",
    "user_agent.browser_version": "65.0.3325.181",
    "name": "Welcome",
    "http.headers.upgrade-insecure-requests": "1",
    "peer.ipv4_string": "127.0.0.0"
  },
  {
    "duration_cpu_ms": 35.622374,
    "instance": "dev",
    "http.headers.accept-language": "it-IT,it;q=0.9,en-US;q=0.8,en;q=0.7",
    "tracking.unique_visitor_id": "2a5a943dc195052d486d6dbd1feb3923686d669b",
    "http.headers.x-b3-sampled": "1",
    "http.url": "/spring-petclinic/owners.html",
    "type": "http",
    "http.headers.accept": "*/*",
    "error": true,
    "http.headers.referer": "http://34.245.47.230/spring-petclinic/",
    "bytes_written": 149,
    "user_agent.type": "Browser",
    "http.headers.connection": "close",
    "http.headers.host": "localhost:8080",
    "span.kind": "server",
    "host": "ip-172-31-22-53",
    "http.headers.x-b3-spanid": "a379b97bcbafa5e1",
    "user_agent.os_version": "10.0",
    "id": "22d72c054e27f02a",
    "http.headers.x-requested-with": "XMLHttpRequest",
    "user_agent.browser": "Chrome",
    "call_tree_ascii": "----------------------------------------------------------------------\nSelftime (ms)              Total (ms)                 Method signature\n----------------------------------------------------------------------\n000039.01  029% ██▓░░░░░░░ 000134.82  100% ██████████ Error\n000004.85  004% ░░░░░░░░░░ 000004.85  004% ░░░░░░░░░░ ├── FrameworkServlet#service\n000090.96  067% ██████▓░░░ 000090.96  067% ██████▓░░░ └── FrameworkServlet#service\n",
    "trace_id": "a379b97bcbafa5e1",
    "method": "GET",
    "http.headers.x-b3-traceid": "a379b97bcbafa5e1",
    "ip": "127.0.0.0",
    "user_agent.os_family": "Windows",
    "http.headers.user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36",
    "peer.port": 42964,
    "duration_ms": 126.827804,
    "http.status_code": 404,
    "http.headers.accept-encoding": "gzip, deflate",
    "@timestamp": "2018-03-29T13:02:39.008+0000",
    "application": "Spring-Petclinic",
    "user_agent.os": "Windows",
    "parent_id": "a379b97bcbafa5e1",
    "stagemonitor.version": "0.87.5",
    "http.referring_site": "34.245.47.230",
    "user_agent.device": "Personal computer",
    "user_agent.browser_version": "65.0.3325.181",
    "name": "Error",
    "peer.ipv4_string": "127.0.0.0",
    "parameters": [
      {
        "key": "lastName",
        "value": ""
      }
    ]
  },
  {
    "duration_cpu_ms": 537.38167,
    "instance": "dev",
    "http.headers.accept-language": "it-IT,it;q=0.9,en-US;q=0.8,en;q=0.7",
    "tracking.unique_visitor_id": "2a5a943dc195052d486d6dbd1feb3923686d669b",
    "http.url": "/spring-petclinic/",
    "type": "http",
    "http.headers.accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8",
    "error": false,
    "user_agent.type": "Browser",
    "http.headers.connection": "close",
    "http.headers.host": "localhost:8080",
    "span.kind": "server",
    "host": "ip-172-31-22-53",
    "user_agent.os_version": "10.0",
    "id": "ec76860dfe81268f",
    "user_agent.browser": "Chrome",
    "call_tree_ascii": "----------------------------------------------------------------------\nSelftime (ms)              Total (ms)                 Method signature\n----------------------------------------------------------------------\n000137.18  008% ▓░░░░░░░░░ 001622.01  100% ██████████ Welcome\n000092.12  006% ▓░░░░░░░░░ 001484.83  092% █████████░ └── FrameworkServlet#service\n001392.71  086% ████████▓░ 001392.71  086% ████████▓░     └── DispatcherServlet#render\n",
    "trace_id": "ec76860dfe81268f",
    "method": "GET",
    "ip": "127.0.0.0",
    "user_agent.os_family": "Windows",
    "http.headers.user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36",
    "peer.port": 42884,
    "duration_ms": 1614.6859,
    "http.status_code": 200,
    "http.headers.accept-encoding": "gzip, deflate",
    "@timestamp": "2018-03-29T13:02:35.530+0000",
    "application": "Spring-Petclinic",
    "user_agent.os": "Windows",
    "parent_id": "904df5f1ce20d3d5",
    "stagemonitor.version": "0.87.5",
    "user_agent.device": "Personal computer",
    "gc_time_ms": 97,
    "user_agent.browser_version": "65.0.3325.181",
    "name": "Welcome",
    "http.headers.upgrade-insecure-requests": "1",
    "peer.ipv4_string": "127.0.0.0"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select visits0_.pet_id as pet_id4_6_0_, visits0_.id as id1_6_0_, visits0_.id as id1_6_1_, visits0_.visit_date as visit_da2_6_1_, visits0_.description as descript3_6_1_, visits0_.pet_id as pet_id4_6_1_ from visits visits0_ where visits0_.pet_id=12",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.282868,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.694+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "4e856e58e918ec39"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=3",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.13352,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.683+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "56633d60654a194c"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=5",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.978125,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.688+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "414e45639cccc21a"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select visits0_.pet_id as pet_id4_6_0_, visits0_.id as id1_6_0_, visits0_.id as id1_6_1_, visits0_.visit_date as visit_da2_6_1_, visits0_.description as descript3_6_1_, visits0_.pet_id as pet_id4_6_1_ from visits visits0_ where visits0_.pet_id=11",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.139191,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.695+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "e84f153a01200b9d"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=4",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.135892,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.684+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "8254a27499cd6ca9"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select visits0_.pet_id as pet_id4_6_0_, visits0_.id as id1_6_0_, visits0_.id as id1_6_1_, visits0_.visit_date as visit_da2_6_1_, visits0_.description as descript3_6_1_, visits0_.pet_id as pet_id4_6_1_ from visits visits0_ where visits0_.pet_id=13",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.15847,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.691+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "69e3731e7da076d2"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=6",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.149008,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.681+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "6206489914b40c04"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select distinct owner0_.id as id1_0_0_, pets1_.id as id1_1_1_, owner0_.first_name as first_na2_0_0_, owner0_.last_name as last_nam3_0_0_, owner0_.address as address4_0_0_, owner0_.city as city5_0_0_, owner0_.telephone as telephon6_0_0_, pets1_.name as name2_1_1_, pets1_.birth_date as birth_da3_1_1_, pets1_.owner_id as owner_id4_1_1_, pets1_.type_id as type_id5_1_1_, pets1_.owner_id as owner_id4_1_0__, pets1_.id as id1_1_0__ from owners owner0_ left outer join pets pets1_ on owner0_.id=pets1_.owner_id where owner0_.last_name like '%'",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.554853,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.665+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "7ef2ace0ec2bbe10"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=1",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.284367,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.680+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "4e9e4056772eaa3f"
  },
  {
    "trace_id": "492223f90c99162e",
    "db.type": "HSQL Database Engine",
    "instance": "dev",
    "method": "SELECT",
    "db.statement": "select pettype0_.id as id1_3_0_, pettype0_.name as name2_3_0_ from types pettype0_ where pettype0_.id=2",
    "type": "jdbc",
    "error": false,
    "duration_ms": 0.148362,
    "db.user": "SA",
    "@timestamp": "2018-03-28T13:29:04.682+0000",
    "application": "Spring-Petclinic",
    "span.kind": "client",
    "parent_id": "492223f90c99162e",
    "peer.service": "SA@jdbc:hsqldb:mem:testdb",
    "stagemonitor.version": "0.87.5",
    "host": "ip-172-31-22-53",
    "name": "OwnerController#processFindForm",
    "id": "e355133eb17ffb7c"
  }
]

const gb = new GBuilder();

describe('GraphBuilder tester', () => {
  describe('Testing getLinks function', () => {
    let links = gb.getLinks(nodes, mdata);
    it('it should return array with nodes\' links', () => {
      links.should.be.an('array');
    })
    it('it should be well structured', () => {
      links[0].should.have.deep.property('source')
      links[0].should.have.deep.property('target')
      links[0].should.have.deep.property('type')
    })
    it('it shouldn\'t have duplicated links', () => {
      for (var i = 0; i < links.length; i++) {
        for (var j = i + 1; j < links.length; j++) {
          if (links[j].id == links[i].id) {
          if (links[i].source == links[j].links && links[i].target == links[j].target)
            throw new Error("Found duplicated links")
          }
        }
      }
    })

  }) // describe

  describe('Testing getNodes function', () => {
    let nodes = gb.getNodes(mdata);
    it('it should return array with nodes', () => {
      nodes.should.be.an('array');
    })
    it('it should be well structured', () => {
      nodes[0].should.have.deep.property('name')
      nodes[0].should.have.deep.property('type')
      nodes[0].should.have.deep.property('id')
    })
    it('it shouldn\'t have duplicated nodes', () => {
      for (var i = 0; i < nodes.length; i++) {
        for (var j = i + 1; j < nodes.length; j++) {
          if (nodes[j].id == nodes[i].id) {
            throw new Error("Found duplicated nodes")
          }
        }
      }
    })

  }) // describe
})
